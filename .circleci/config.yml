# https://circleci.com/docs/2.0/configuration-reference/
# https://circleci.com/docs/2.0/testing-ios/#supported-xcode-versions
version: 2.1

.build: &build
  steps:
    - checkout
    - run:
        name: Install realpath & co.
        command: brew install coreutils
    - run:
        name: Build all the tests
        command: bash -x build.sh

jobs:
  xcode-11_2_1-macos-10_15:
    macos: {xcode: "11.2.1"}
    <<: *build
  xcode-11_1_0-macos-10_14:
    macos: {xcode: "11.1.0"}
    <<: *build
  # module compiled with Swift 5.1.2 cannot be imported by the Swift 5.0.1 compiler
  # xcode-10_3_0-macos-10_14:
  #   macos: {xcode: "10.3.0"}
  #   <<: *build

workflows:
  build:
    jobs:
      - xcode-11_2_1-macos-10_15
      - xcode-11_1_0-macos-10_14
      # - xcode-10_3_0-macos-10_14